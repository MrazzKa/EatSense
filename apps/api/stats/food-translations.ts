/**
 * Food Name Translations RU → EN
 * Used for PDF reports when locale='en' but food names are in Russian from DB
 */

export const FOOD_TRANSLATIONS_RU_EN: Record<string, string> = {
    // Proteins
    'куриная грудка': 'Chicken breast',
    'курица': 'Chicken',
    'куриное филе': 'Chicken fillet',
    'индейка': 'Turkey',
    'говядина': 'Beef',
    'свинина': 'Pork',
    'телятина': 'Veal',
    'баранина': 'Lamb',
    'рыба': 'Fish',
    'лосось': 'Salmon',
    'тунец': 'Tuna',
    'скумбрия': 'Mackerel',
    'сельдь': 'Herring',
    'треска': 'Cod',
    'форель': 'Trout',
    'креветки': 'Shrimp',
    'яйца': 'Eggs',
    'яйцо': 'Egg',
    'яичница': 'Fried eggs',
    'омлет': 'Omelette',
    'творог': 'Cottage cheese',
    'сыр': 'Cheese',
    'йогурт': 'Yogurt',
    'кефир': 'Kefir',
    'молоко': 'Milk',
    'сметана': 'Sour cream',
    'тофу': 'Tofu',

    // Grains & Carbs
    'рис': 'Rice',
    'рис отварной': 'Boiled rice',
    'гречка': 'Buckwheat',
    'гречневая каша': 'Buckwheat porridge',
    'овсянка': 'Oatmeal',
    'овсяная каша': 'Oatmeal porridge',
    'макароны': 'Pasta',
    'спагетти': 'Spaghetti',
    'хлеб': 'Bread',
    'хлеб белый': 'White bread',
    'хлеб чёрный': 'Black bread',
    'хлеб ржаной': 'Rye bread',
    'лаваш': 'Lavash',
    'батон': 'Baguette',
    'булка': 'Bun',
    'киноа': 'Quinoa',
    'перловка': 'Pearl barley',
    'пшено': 'Millet',
    'булгур': 'Bulgur',
    'кускус': 'Couscous',
    'картофель': 'Potato',
    'картошка': 'Potato',
    'пюре': 'Mashed potato',

    // Vegetables
    'овощи': 'Vegetables',
    'салат': 'Salad',
    'огурец': 'Cucumber',
    'огурцы': 'Cucumbers',
    'помидор': 'Tomato',
    'помидоры': 'Tomatoes',
    'капуста': 'Cabbage',
    'брокколи': 'Broccoli',
    'цветная капуста': 'Cauliflower',
    'морковь': 'Carrot',
    'свёкла': 'Beet',
    'лук': 'Onion',
    'чеснок': 'Garlic',
    'перец': 'Pepper',
    'болгарский перец': 'Bell pepper',
    'баклажан': 'Eggplant',
    'кабачок': 'Zucchini',
    'тыква': 'Pumpkin',
    'шпинат': 'Spinach',
    'зелень': 'Greens',
    'петрушка': 'Parsley',
    'укроп': 'Dill',
    'сельдерей': 'Celery',
    'авокадо': 'Avocado',
    'грибы': 'Mushrooms',
    'фасоль': 'Beans',
    'горох': 'Peas',
    'чечевица': 'Lentils',
    'нут': 'Chickpeas',

    // Fruits
    'фрукты': 'Fruits',
    'яблоко': 'Apple',
    'яблоки': 'Apples',
    'банан': 'Banana',
    'апельсин': 'Orange',
    'мандарин': 'Tangerine',
    'груша': 'Pear',
    'виноград': 'Grapes',
    'клубника': 'Strawberry',
    'малина': 'Raspberry',
    'черника': 'Blueberry',
    'арбуз': 'Watermelon',
    'дыня': 'Melon',
    'персик': 'Peach',
    'абрикос': 'Apricot',
    'слива': 'Plum',
    'киви': 'Kiwi',
    'манго': 'Mango',
    'ананас': 'Pineapple',
    'гранат': 'Pomegranate',
    'ягоды': 'Berries',

    // Nuts & Seeds
    'орехи': 'Nuts',
    'миндаль': 'Almonds',
    'грецкий орех': 'Walnut',
    'фундук': 'Hazelnut',
    'кешью': 'Cashew',
    'арахис': 'Peanut',
    'семечки': 'Seeds',
    'семена подсолнуха': 'Sunflower seeds',
    'семена льна': 'Flax seeds',
    'семена чиа': 'Chia seeds',

    // Prepared dishes
    'суп': 'Soup',
    'борщ': 'Borscht',
    'щи': 'Shchi (cabbage soup)',
    'солянка': 'Solyanka',
    'уха': 'Fish soup',
    'окрошка': 'Okroshka',
    'каша': 'Porridge',
    'плов': 'Pilaf',
    'котлета': 'Cutlet',
    'котлеты': 'Cutlets',
    'шашлык': 'Shashlik',
    'пельмени': 'Dumplings',
    'вареники': 'Vareniki',
    'блины': 'Pancakes',
    'оладьи': 'Fritters',
    'сырники': 'Cheese pancakes',
    'запеканка': 'Casserole',
    'голубцы': 'Stuffed cabbage',
    'жаркое': 'Roast',
    'рагу': 'Stew',
    'стейк': 'Steak',
    'бургер': 'Burger',
    'пицца': 'Pizza',
    'сэндвич': 'Sandwich',
    'бутерброд': 'Sandwich',
    'роллы': 'Rolls',
    'суши': 'Sushi',

    // Drinks
    'кофе': 'Coffee',
    'чай': 'Tea',
    'сок': 'Juice',
    'вода': 'Water',
    'компот': 'Kompot',
    'морс': 'Mors',
    'смузи': 'Smoothie',
    'коктейль': 'Cocktail',

    // Sweets & Snacks
    'шоколад': 'Chocolate',
    'конфеты': 'Candy',
    'печенье': 'Cookies',
    'торт': 'Cake',
    'пирог': 'Pie',
    'мороженое': 'Ice cream',
    'мёд': 'Honey',
    'варенье': 'Jam',
    'чипсы': 'Chips',
    'сухарики': 'Crackers',

    // Sauces & Condiments
    'масло': 'Oil',
    'оливковое масло': 'Olive oil',
    'сливочное масло': 'Butter',
    'майонез': 'Mayonnaise',
    'кетчуп': 'Ketchup',
    'соус': 'Sauce',
    'соевый соус': 'Soy sauce',
    'горчица': 'Mustard',
    'уксус': 'Vinegar',
    'соль': 'Salt',
    'сахар': 'Sugar',
    'специи': 'Spices',

    // Generic
    'еда': 'Food',
    'блюдо': 'Dish',
    'порция': 'Portion',
    'завтрак': 'Breakfast',
    'обед': 'Lunch',
    'ужин': 'Dinner',
    'перекус': 'Snack',
};

/**
 * Check if string contains Cyrillic characters
 */
export function containsCyrillic(text: string): boolean {
    return /[а-яёА-ЯЁ]/.test(text);
}

/**
 * Normalize food label for locale
 * When locale='en' and food name is in Russian, translate it
 */
export function normalizeFoodLabelForLocale(label: string, locale: string): string {
    if (!label) return 'Unknown food';

    // Trim and normalize
    let normalized = label.trim().replace(/\s+/g, ' ');

    // If EN locale and text contains Cyrillic, try to translate
    if (locale === 'en' && containsCyrillic(normalized)) {
        const lowerLabel = normalized.toLowerCase();

        // Try exact match first
        if (FOOD_TRANSLATIONS_RU_EN[lowerLabel]) {
            return FOOD_TRANSLATIONS_RU_EN[lowerLabel];
        }

        // Try to find partial match (first word)
        const firstWord = lowerLabel.split(' ')[0];
        if (FOOD_TRANSLATIONS_RU_EN[firstWord]) {
            // Replace first word and keep rest
            const rest = normalized.slice(firstWord.length).trim();
            return FOOD_TRANSLATIONS_RU_EN[firstWord] + (rest ? ` (${rest})` : '');
        }

        // No translation found - return "Food item" + original in parentheses
        return `Food item (${normalized})`;
    }

    // For RU/KK locale or non-Cyrillic text, return as-is with Title Case
    return normalized.charAt(0).toUpperCase() + normalized.slice(1);
}

/**
 * Get meal type translation key from raw database value
 */
export function normalizeMealType(rawType: string): string {
    const normalizations: Record<string, string> = {
        'breakfast': 'BREAKFAST',
        'lunch': 'LUNCH',
        'dinner': 'DINNER',
        'snack': 'SNACK',
        'завтрак': 'BREAKFAST',
        'обед': 'LUNCH',
        'ужин': 'DINNER',
        'перекус': 'SNACK',
        'BREAKFAST': 'BREAKFAST',
        'LUNCH': 'LUNCH',
        'DINNER': 'DINNER',
        'SNACK': 'SNACK',
    };

    return normalizations[rawType?.toLowerCase()] || normalizations[rawType] || 'SNACK';
}
